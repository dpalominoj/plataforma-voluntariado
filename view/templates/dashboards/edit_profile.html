{% extends "dashboard.base.html" %}
{% from "_form_helpers.html" import render_field %}

{% block title %}{{ title }}{% endblock %}

{% block dashboard_content %}
<div class="container mt-4">
    <h2 class="mb-4">{{ title }}</h2>

    {# Mostrar DNI (no editable) #}
    {% if current_user and current_user.DNI %}
    <div class="alert alert-info">
        <strong>DNI:</strong> {{ current_user.DNI }} (No editable)
    </div>
    {% endif %}

    {# Mostrar mensajes flash #}
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <form method="POST" action="{{ url_for('profile.edit_profile') }}" novalidate>
        {{ form.hidden_tag() }} {# CSRF token #}

        <div class="row">
            <div class="col-md-6">
                {{ render_field(form.nombre, class="form-control") }}
            </div>
            <div class="col-md-6">
                {{ render_field(form.apellido, class="form-control") }}
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                {{ render_field(form.email, class="form-control", type="email") }}
            </div>
            <div class="col-md-6">
                {{ render_field(form.celular, class="form-control", type="tel") }}
            </div>
        </div>

        {{ render_field(form.direccion, class="form-control") }}

        <div class="row">
            <div class="col-md-6">
                {{ render_field(form.fecha_nacimiento, class="form-control", placeholder="YYYY-MM-DD", type="text", help_text="Formato: Año-Mes-Día") }}
            </div>
            <div class="col-md-6">
                {{ render_field(form.genero, class="form-select") }}
            </div>
        </div>

        <div class="mt-4">
            {{ form.submit(class="btn btn-primary") }}
            <a href="{{ url_for('user_dashboard.dashboard') }}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>
{% endblock %}
